---
title: 防抖与节流
date: 2018-09-26 17:23:50
tags: js
---
在平时开发的过程中，滚动事件计算高度等等频繁调用回调函数会造成页面的卡顿，这时候我们希望把多次计算调用合并成一次，只操作一个精确点，JS把这种方式称为debounce（防抖）和throttle（节流）

<!-- more -->

## 防抖

很简单，一个我们平时会用到的例子，就是在一个列表滚动时，根据滚动的位置做相应的回调。
来看一个例子

    function debounce(fn, wait) {
        var timeout = null;      //定义一个定时器
        return function() {
            if(timeout !== null) {
                clearTimeout(timeout);  //清除这个定时器
            }     
            timeout = setTimeout(fn, wait); // 设置这个定时器  
        }
    }
    // 处理函数
    function handle() {
        console.log(Math.random()); 
    }
    // 滚动事件
    window.addEventListener('scroll', debounce(handle, 1000));

可以看到，函数在1秒内只执行一次，如果频繁触发，会清空当前的定时器，重新设置一个定时器，延后一秒执行，换句话说就是，只有你不动了以后的一段延迟时间内，回调函数才会被执行

## 节流

同样是一个列表，我们依旧在他滚动的时候，根据滚动的位置做相应的回调
来看下面的例子

    var throttle = function(func, delay) {
        var timer = null;
        return function() {
            var context = this;
            var args = arguments;
            if (!timer) {
                timer = setTimeout(function() {
                    func.apply(context, args);
                    timer = null;
                }, delay);
            }
        }
    }
    function handle() {
        console.log(Math.random());
    }
    window.addEventListener('scroll', throttle(handle, 1000));

可以看到，在频繁滚动的情况下，假设你1秒内滚动了1000次，按道理来说我们要触发1000次回调，但是用了节流，我们只关注在规定时间内的触发，换句话说就是，如果你一直动，就每隔一段时间触发一次


## 总结

总结防抖和节流的区别：防抖是将多次执行变为最后一次执行，节流是将多次执行变为每隔一段时间执行
